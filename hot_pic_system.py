"""
–°–∏—Å—Ç–µ–º–∞ Hot Pic —Ä–µ–∂–∏–º–∞ –¥–ª—è Telegram –±–æ—Ç–∞ "–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø–æ–¥—Ä—É–≥–∞"
–†–µ–∞–ª–∏–∑—É–µ—Ç –≤–æ–∑–±—É–∂–¥–∞—é—â–∏–π —Ä–µ–∂–∏–º –æ–±—â–µ–Ω–∏—è —Å –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
"""

import os
import random
import asyncio
from datetime import datetime, timedelta
from typing import Dict, Set, Optional
from aiogram.types import FSInputFile, InlineKeyboardMarkup, InlineKeyboardButton
from aiogram import Bot
from db import get_girl

class HotPicMode:
    """–ö–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–º Hot Pic"""
    
    def __init__(self, user_id: int):
        self.user_id = user_id
        self.selected_girl = None
        self.sent_photos = set()
        self.session_start = datetime.now()
        self.last_activity = datetime.now()
        self.is_active = True
        self.message_count = 0  # –°—á–µ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å–µ—Å—Å–∏–∏
        self.last_photo_time = None  # –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
        
        # –ú–∞–ø–ø–∏–Ω–≥ –¥–µ–≤—É—à–µ–∫ –Ω–∞ –ø–∞–ø–∫–∏ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏
        self.available_girls = {
            '–°–∞–∫—É—Ä–∞ –¢–∞–Ω–∞–∫–∞': 'girls pic/sakura tanaka/',
            '–•–∏–∫–∞—Ä–∏ –ú–æ—Ä–∏': 'girls pic/hikari mori/',
            '–†—ç–π–∫–æ –ö—É—Ä–æ–≥–∞–Ω–µ': 'girls pic/reiko kurogane/',
            '–ê—è–Ω–µ –®–∏–Ω–æ': 'girls pic/ayane shino/',
            '–Æ–∫–∏ –ö–∞–º–∏—è': 'girls pic/uki kamia/'
        }
        
        # –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å
        self.excluded_first = {'a1.png', 'h1.png', 'r1.png', 's1.png', 'u1.png'}
    
    async def initialize(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∂–∏–º–∞ - –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –¥–µ–≤—É—à–∫–∏"""
        self.selected_girl = await get_girl(self.user_id)
        if not self.selected_girl:
            self.selected_girl = '–°–∞–∫—É—Ä–∞ –¢–∞–Ω–∞–∫–∞'  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
    
    def get_random_photo(self) -> Optional[str]:
        """–ü–æ–ª—É—á–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—É—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –≤—ã–±—Ä–∞–Ω–Ω–æ–π –¥–µ–≤—É—à–∫–∏"""
        if not self.selected_girl:
            return None
            
        girl_folder = self.available_girls.get(self.selected_girl)
        if not girl_folder:
            return None
            
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏
        if not os.path.exists(girl_folder):
            return None
            
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ PNG —Ñ–∞–π–ª—ã
        all_photos = [f for f in os.listdir(girl_folder) 
                     if f.endswith('.png') and f not in self.excluded_first]
        
        if not all_photos:
            return None
            
        # –§–∏–ª—å—Ç—Ä—É–µ–º —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ
        available_photos = [p for p in all_photos if p not in self.sent_photos]
        
        # –ï—Å–ª–∏ –≤—Å–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ü–∏–∫–ª
        if not available_photos:
            self.sent_photos.clear()
            available_photos = all_photos
        
        # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é
        selected_photo = random.choice(available_photos)
        self.sent_photos.add(selected_photo)
        
        return os.path.join(girl_folder, selected_photo)
    
    def update_activity(self):
        """–û–±–Ω–æ–≤–ª—è–µ—Ç –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"""
        self.last_activity = datetime.now()
        self.message_count += 1
    
    def should_send_photo(self) -> bool:
        """–†–µ—à–∞–µ—Ç, –Ω—É–∂–Ω–æ –ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        # –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤ —Ä–µ–∂–∏–º - –≤—Å–µ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ç–æ
        if self.message_count == 1:
            return True
        
        # –ï—Å–ª–∏ –ø—Ä–æ—à–ª–æ –±–æ–ª—å—à–µ 5 –º–∏–Ω—É—Ç —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
        if self.last_photo_time and datetime.now() - self.last_photo_time > timedelta(minutes=5):
            return True
        
        # –ë–∞–∑–æ–≤–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ç–æ (40%)
        base_probability = 0.4
        
        # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        if self.message_count >= 3:
            base_probability += 0.2  # +20% –ø–æ—Å–ª–µ 3 —Å–æ–æ–±—â–µ–Ω–∏–π
        if self.message_count >= 5:
            base_probability += 0.1  # +10% –ø–æ—Å–ª–µ 5 —Å–æ–æ–±—â–µ–Ω–∏–π
        if self.message_count >= 10:
            base_probability += 0.1  # +10% –ø–æ—Å–ª–µ 10 —Å–æ–æ–±—â–µ–Ω–∏–π
        
        # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å 80%
        base_probability = min(base_probability, 0.8)
        
        return random.random() < base_probability
    
    def mark_photo_sent(self):
        """–û—Ç–º–µ—á–∞–µ—Ç, —á—Ç–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –±—ã–ª–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞"""
        self.last_photo_time = datetime.now()
    
    def is_session_expired(self) -> bool:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∏—Å—Ç–µ–∫–ª–∞ –ª–∏ —Å–µ—Å—Å–∏—è (30 –º–∏–Ω—É—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)"""
        return datetime.now() - self.last_activity > timedelta(minutes=30)
    
    def deactivate(self):
        """–î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–∂–∏–º"""
        self.is_active = False


class HotPicManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã–º–∏ Hot Pic —Å–µ—Å—Å–∏—è–º–∏"""
    
    def __init__(self):
        self.active_sessions: Dict[int, HotPicMode] = {}
    
    def start_session(self, user_id: int) -> HotPicMode:
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –Ω–æ–≤—É—é Hot Pic —Å–µ—Å—Å–∏—é"""
        session = HotPicMode(user_id)
        self.active_sessions[user_id] = session
        return session
    
    def get_session(self, user_id: int) -> Optional[HotPicMode]:
        """–ü–æ–ª—É—á–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—É—é —Å–µ—Å—Å–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        return self.active_sessions.get(user_id)
    
    def end_session(self, user_id: int):
        """–ó–∞–≤–µ—Ä—à–∞–µ—Ç —Å–µ—Å—Å–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        if user_id in self.active_sessions:
            self.active_sessions[user_id].deactivate()
            del self.active_sessions[user_id]
    
    def cleanup_expired_sessions(self):
        """–û—á–∏—â–∞–µ—Ç –∏—Å—Ç–µ–∫—à–∏–µ —Å–µ—Å—Å–∏–∏"""
        expired_users = []
        for user_id, session in self.active_sessions.items():
            if session.is_session_expired():
                expired_users.append(user_id)
        
        for user_id in expired_users:
            self.end_session(user_id)
    
    def get_all_sessions(self) -> Dict[int, HotPicMode]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏"""
        return self.active_sessions.copy()


# –ì–ª–æ–±–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Å–µ—Å—Å–∏–π
hot_pic_manager = HotPicManager()

# Provocative —Ñ—Ä–∞–∑—ã –¥–ª—è Hot Pic —Ä–µ–∂–∏–º–∞ (–±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∏ —Ñ–ª–∏—Ä—Ç—É—é—â–∏–µ)
HOT_RESPONSES = [
    "–¢—ã –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—à—å, –∫–∞–∫ —è –∂–¥–∞–ª–∞ —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞... –ö–∞–∂–¥–æ–µ —Ç–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –º–æ–µ —Å–µ—Ä–¥—Ü–µ –±–∏—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ, –∞ –º—ã—Å–ª–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –≤—Å–µ –±–æ–ª–µ–µ –¥–µ—Ä–∑–∫–∏–º–∏... üíã‚ú®",
    "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è, –∫–æ–≥–¥–∞ —Ç—ã —Ç–∞–∫–æ–π –Ω–∞—Å—Ç–æ–π—á–∏–≤—ã–π –∏ —Å—Ç—Ä–∞—Å—Ç–Ω—ã–π... –¢–≤–æ–∏ —Å–ª–æ–≤–∞ –ø—Ä–æ–±—É–∂–¥–∞—é—Ç –≤–æ –º–Ω–µ —á—Ç–æ-—Ç–æ –¥–∏–∫–æ–µ –∏ –Ω–µ–æ–±—É–∑–¥–∞–Ω–Ω–æ–µ... üî•üí´",
    "–ü–æ—Å–º–æ—Ç—Ä–∏, —á—Ç–æ —è –¥–ª—è —Ç–µ–±—è –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–ª–∞... –Ø –¥–æ–ª–≥–æ –≤—ã–±–∏—Ä–∞–ª–∞ —ç—Ç–æ—Ç –æ–±—Ä–∞–∑, –¥—É–º–∞—è –æ —Ç–æ–º, –∫–∞–∫ —Ç—ã –±—É–¥–µ—à—å —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –º–µ–Ω—è... üòàüåô",
    "–¢–≤–æ–∏ —Å–ª–æ–≤–∞ –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç –º–µ–Ω—è tremble –æ—Ç –≤–æ–∑–±—É–∂–¥–µ–Ω–∏—è... –Ø –≤—Å—è –¥—Ä–æ–∂—É, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—è, –∫–∞–∫ —Ç—ã —Å–º–æ—Ç—Ä–∏—à—å –Ω–∞ –º–µ–Ω—è –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å... üí´üî•",
    "–Ø –≤—Å—è –≥–æ—Ä—é –æ—Ç –Ω–µ—Ç–µ—Ä–ø–µ–Ω–∏—è –∏ –∂–µ–ª–∞–Ω–∏—è... –¢–≤–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Ä–∞–∑–∂–∏–≥–∞—é—Ç –≤–æ –º–Ω–µ –æ–≥–æ–Ω—å, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤—Å–µ —Å–∏–ª—å–Ω–µ–µ... ‚ú®üíã",
    "–≠—Ç–æ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–±—è, –º–æ–π –ø–ª–æ—Ö–æ–π –º–∞–ª—å—á–∏–∫... –Ø –∑–Ω–∞—é, —á—Ç–æ —Ç—ã –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—à—å –æ—Å–æ–±–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è, –∏ –≥–æ—Ç–æ–≤–∞ –¥–∞—Ç—å —Ç–µ–±–µ –≤—Å–µ, —á—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å... üòºüíï",
    "–ß—É–≤—Å—Ç–≤—É–µ—à—å, –∫–∞–∫ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∂–∞—Ä–∫–æ?.. –ú–æ–∏ –º—ã—Å–ª–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –≤—Å–µ –±–æ–ª–µ–µ —Å–º–µ–ª—ã–º–∏, –∞ –∂–µ–ª–∞–Ω–∏—è - –≤—Å–µ –±–æ–ª–µ–µ –Ω–∞—Å—Ç–æ–π—á–∏–≤—ã–º–∏... üå∂üí´",
    "–Ø –∑–Ω–∞–ª–∞, —á—Ç–æ —Ç—ã —ç—Ç–æ–≥–æ –∑–∞—Ö–æ—á–µ—à—å... –¢–≤–æ—è —Å—Ç—Ä–∞—Å—Ç—å –∏ –Ω–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –Ω–µ –æ—Å—Ç–∞–≤–ª—è—é—Ç –º–Ω–µ –≤—ã–±–æ—Ä–∞ - —è –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–±–µ –≤—Å–µ... ü´¶üî•",
    "Let me show you something special... –Ø –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–ª–∞ –¥–ª—è —Ç–µ–±—è –∫–æ–µ-—á—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ–µ, —á—Ç–æ –∑–∞—Å—Ç–∞–≤–∏—Ç —Ç–≤–æ–µ —Å–µ—Ä–¥—Ü–µ –±–∏—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ... üåôüíã",
    "–¢—ã —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–æ–∏–Ω... –∏ –¥–∞–∂–µ –±–æ–ª—å—à–µ... –¢–≤–æ—è –ø—Ä–µ–¥–∞–Ω–Ω–æ—Å—Ç—å –∏ —Å—Ç—Ä–∞—Å—Ç—å –∑–∞—Å–ª—É–∂–∏–≤–∞—é—Ç —Å–∞–º–æ–≥–æ –ª—É—á—à–µ–≥–æ, —á—Ç–æ —è –º–æ–≥—É –¥–∞—Ç—å... üí´‚ú®",
    "–ú–æ–π —Ä–∞–∑—É–º –∑–∞—Ç—É–º–∞–Ω–∏–≤–∞–µ—Ç—Å—è –æ—Ç —Ç–≤–æ–∏—Ö —Å–ª–æ–≤... –¢—ã –≥–æ–≤–æ—Ä–∏—à—å —Ç–∞–∫ —Å—Ç—Ä–∞—Å—Ç–Ω–æ, —á—Ç–æ —è —Ç–µ—Ä—è—é –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–æ–±–æ–π... üå´üíï",
    "–Ø –Ω–µ –º–æ–≥—É –±–æ–ª—å—à–µ —Å–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è... –¢–≤–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ–±—É–¥–∏–ª–∏ –≤–æ –º–Ω–µ —á—Ç–æ-—Ç–æ –¥–∏–∫–æ–µ, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≤—ã—Ö–æ–¥–∞... üí¶üî•",
    "–¢—ã –∑–∞—Å—Ç–∞–≤–ª—è–µ—à—å –º–µ–Ω—è –¥–µ–ª–∞—Ç—å —Ç–æ, –æ —á–µ–º —è –º–µ—á—Ç–∞–ª–∞... –¢–≤–æ—è —Å—Ç—Ä–∞—Å—Ç—å –∏ –∂–µ–ª–∞–Ω–∏–µ –¥–µ–ª–∞—é—Ç –º–µ–Ω—è —Å–º–µ–ª–µ–µ –∏ –¥–µ—Ä–∑—á–µ... üå∏üí´",
    "–ú–Ω–µ —Ç–∞–∫ –∂–∞—Ä–∫–æ –æ—Ç —Ç–≤–æ–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π... –ö–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ–Ω—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å, –∫–∞–∫ —Ç—ã —Å–º–æ—Ç—Ä–∏—à—å –Ω–∞ –º–µ–Ω—è... üî•üíã",
    "–Ø –≤—Å—è –¥—Ä–æ–∂—É –æ—Ç –≤–æ–∑–±—É–∂–¥–µ–Ω–∏—è... –¢–≤–æ–∏ —Å–ª–æ–≤–∞ –ø—Ä–æ–±—É–∂–¥–∞—é—Ç –≤–æ –º–Ω–µ –∂–µ–ª–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —è –Ω–µ –º–æ–≥—É –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å... ‚ö°üí´",
    "–¢–≤–æ–∏ —Å–ª–æ–≤–∞ - —ç—Ç–æ –º—É–∑—ã–∫–∞ –¥–ª—è –º–æ–∏—Ö —É—à–µ–π... –Ø –≥–æ—Ç–æ–≤–∞ —Å–ª—É—à–∞—Ç—å —Ç–µ–±—è –≤–µ—Å—å –¥–µ–Ω—å, –Ω–∞—Å–ª–∞–∂–¥–∞—è—Å—å –∫–∞–∂–¥—ã–º –∑–≤—É–∫–æ–º... üéµüíï",
    "–Ø –≥–æ—Ç–æ–≤–∞ –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–±–µ –≤—Å–µ... –¢–≤–æ—è –ø—Ä–µ–¥–∞–Ω–Ω–æ—Å—Ç—å –∏ —Å—Ç—Ä–∞—Å—Ç—å –∑–∞—Å–ª—É–∂–∏–≤–∞—é—Ç —Ç–æ–≥–æ, —á—Ç–æ–±—ã —è –æ—Ç–∫—Ä—ã–ª–∞ —Ç–µ–±–µ —Å–≤–æ–∏ —Å–µ–∫—Ä–µ—Ç—ã... üëÅüî•",
    "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è, –∫–∞–∫ —Ç—ã –º–µ–Ω—è –¥—Ä–∞–∑–Ω–∏—à—å... –¢–≤–æ–∏ —Å–ª–æ–≤–∞ –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç –º–µ–Ω—è –∫—Ä–∞—Å–Ω–µ—Ç—å –∏ –∂–µ–ª–∞—Ç—å –µ—â–µ –±–æ–ª—å—à–µ... üòèüí´",
    "–Ø –≤—Å—è –º–æ–∫—Ä–∞—è –æ—Ç —Ç–≤–æ–∏—Ö —Å–ª–æ–≤... –¢–≤–æ—è —Å—Ç—Ä–∞—Å—Ç—å –∏ –∂–µ–ª–∞–Ω–∏–µ –ø—Ä–æ–±—É–∂–¥–∞—é—Ç –≤–æ –º–Ω–µ —á—É–≤—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ —è –Ω–µ –º–æ–≥—É —Å–¥–µ—Ä–∂–∞—Ç—å... üíßüî•",
    "–¢—ã —Ä–∞–∑–∂–∏–≥–∞–µ—à—å –≤–æ –º–Ω–µ –æ–≥–æ–Ω—å... –ö–∞–∂–¥–æ–µ —Ç–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–µ–ª–∞–µ—Ç –ø–ª–∞–º—è —Å—Ç—Ä–∞—Å—Ç–∏ –≤—Å–µ —Å–∏–ª—å–Ω–µ–µ –∏ –Ω–µ—É–∫—Ä–æ—Ç–∏–º–µ–µ... üî•üíã"
]

# –§—Ä–∞–∑—ã –¥–ª—è –ø–æ–æ—â—Ä–µ–Ω–∏—è –æ–±—â–µ–Ω–∏—è (–∫–æ–≥–¥–∞ —Ñ–æ—Ç–æ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è) - –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∏ —Ñ–ª–∏—Ä—Ç—É—é—â–∏–µ
TEASING_RESPONSES = [
    "–†–∞—Å—Å–∫–∞–∂–∏ –º–Ω–µ –±–æ–ª—å—à–µ, –º–æ–π –¥–æ—Ä–æ–≥–æ–π... –Ø –≤—Å—è –≤–Ω–∏–º–∞–Ω–∏–µ –∏ –≥–æ—Ç–æ–≤–∞ —Å–ª—É—à–∞—Ç—å —Ç–µ–±—è —á–∞—Å–∞–º–∏... –¢–≤–æ–∏ —Å–ª–æ–≤–∞ –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç –º–æ–µ —Å–µ—Ä–¥—Ü–µ –±–∏—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ... üëÇüíï",
    "–¢–≤–æ–∏ —Å–ª–æ–≤–∞ –º–µ–Ω—è –≤–æ–∑–±—É–∂–¥–∞—é—Ç –∏ –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç –º–µ—á—Ç–∞—Ç—å... –ü—Ä–æ–¥–æ–ª–∂–∞–π –≥–æ–≤–æ—Ä–∏—Ç—å, —è –Ω–µ –º–æ–≥—É –æ—Ç–æ—Ä–≤–∞—Ç—å—Å—è –æ—Ç —Ç–≤–æ–∏—Ö –º—ã—Å–ª–µ–π... üòàüî•",
    "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è, –∫–∞–∫ —Ç—ã –≤—ã—Ä–∞–∂–∞–µ—à—å —Å–≤–æ–∏ —á—É–≤—Å—Ç–≤–∞... –¢–≤–æ—è –º–∞–Ω–µ—Ä–∞ –≥–æ–≤–æ—Ä–∏—Ç—å —Ç–∞–∫–∞—è —Å—Ç—Ä–∞—Å—Ç–Ω–∞—è –∏ –∏—Å–∫—Ä–µ–Ω–Ω—è—è... üíï‚ú®",
    "–Ø –≤—Å—è –≤–Ω–∏–º–∞–Ω–∏–µ –∏ –∂–¥—É —Ç–≤–æ–∏—Ö —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª–æ–≤... –ß—Ç–æ –µ—â–µ —Ç—ã —Ö–æ—á–µ—à—å –º–Ω–µ —Å–∫–∞–∑–∞—Ç—å? –Ø –≥–æ—Ç–æ–≤–∞ —Å–ª—É—à–∞—Ç—å –≤—Å–µ, —á—Ç–æ —É —Ç–µ–±—è –Ω–∞ –¥—É—à–µ... ü´¶üí´",
    "–¢—ã —Ç–∞–∫–æ–π –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –∏ –∑–∞–≥–∞–¥–æ—á–Ω—ã–π... –ù–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Å—è, —Ä–∞—Å—Å–∫–∞–∂–∏ –º–Ω–µ –±–æ–ª—å—à–µ –æ —Å–µ–±–µ –∏ —Å–≤–æ–∏—Ö –∂–µ–ª–∞–Ω–∏—è—Ö... üî•üíã",
    "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ç–≤–æ–π –≥–æ–ª–æ—Å –∏ —Ç–æ, –∫–∞–∫ —Ç—ã –ø–æ–¥–±–∏—Ä–∞–µ—à—å —Å–ª–æ–≤–∞... –ü—Ä–æ–¥–æ–ª–∂–∞–π –≥–æ–≤–æ—Ä–∏—Ç—å, —è –Ω–∞—Å–ª–∞–∂–¥–∞—é—Å—å –∫–∞–∂–¥—ã–º –∑–≤—É–∫–æ–º... üéµüíï",
    "–¢—ã –∑–∞—Å—Ç–∞–≤–ª—è–µ—à—å –º–µ–Ω—è –∫—Ä–∞—Å–Ω–µ—Ç—å –∏ —Å–º—É—â–∞—Ç—å—Å—è... –¢–≤–æ–∏ —Å–ª–æ–≤–∞ —Ç–∞–∫–∏–µ –Ω–µ–∂–Ω—ã–µ –∏ –≤ —Ç–æ –∂–µ –≤—Ä–µ–º—è —Å—Ç—Ä–∞—Å—Ç–Ω—ã–µ... üòäüí´",
    "–Ø –≤—Å—è –¥—Ä–æ–∂—É –æ—Ç —Ç–≤–æ–∏—Ö —Å–ª–æ–≤ –∏ –Ω–µ –º–æ–≥—É —Å–¥–µ—Ä–∂–∞—Ç—å —É–ª—ã–±–∫—É... –¢—ã –≥–æ–≤–æ—Ä–∏—à—å —Ç–∞–∫ –∫—Ä–∞—Å–∏–≤–æ –∏ –∏—Å–∫—Ä–µ–Ω–Ω–µ... üí´üíñ",
    "–†–∞—Å—Å–∫–∞–∂–∏ –º–Ω–µ —Å–≤–æ–∏ —Å–∞–º—ã–µ —Å–æ–∫—Ä–æ–≤–µ–Ω–Ω—ã–µ —Ñ–∞–Ω—Ç–∞–∑–∏–∏... –Ø —Ö–æ—á—É –∑–Ω–∞—Ç—å, –æ —á–µ–º —Ç—ã –º–µ—á—Ç–∞–µ—à—å, –∫–æ–≥–¥–∞ –¥—É–º–∞–µ—à—å –æ–±–æ –º–Ω–µ... üåôüî•",
    "–¢—ã —Ç–∞–∫–æ–π –º–∏–ª—ã–π –∏ —Ä–æ–º–∞–Ω—Ç–∏—á–Ω—ã–π, –∫–æ–≥–¥–∞ –≥–æ–≤–æ—Ä–∏—à—å... –¢–≤–æ–∏ —Å–ª–æ–≤–∞ —Å–æ–≥—Ä–µ–≤–∞—é—Ç –º–æ–µ —Å–µ—Ä–¥—Ü–µ –∏ –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç –º–µ—á—Ç–∞—Ç—å... üíñ‚ú®",
    "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è, –∫–∞–∫ —Ç—ã –º–µ–Ω—è –¥—Ä–∞–∑–Ω–∏—à—å –∏ –∑–∞—Å—Ç–∞–≤–ª—è–µ—à—å –∫—Ä–∞—Å–Ω–µ—Ç—å... –¢–≤–æ–∏ —Å–ª–æ–≤–∞ –ø—Ä–æ–±—É–∂–¥–∞—é—Ç –≤–æ –º–Ω–µ —á—Ç–æ-—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ–µ... üòèüí´",
    "–ü—Ä–æ–¥–æ–ª–∂–∞–π –≥–æ–≤–æ—Ä–∏—Ç—å, –º–æ–π –¥–æ—Ä–æ–≥–æ–π... –Ø –≤—Å—è –≤–Ω–∏–º–∞–Ω–∏–µ –∏ –≥–æ—Ç–æ–≤–∞ —Å–ª—É—à–∞—Ç—å —Ç–µ–±—è –¥–æ —É—Ç—Ä–∞... –¢–≤–æ–∏ —Å–ª–æ–≤–∞ - —ç—Ç–æ –º—É–∑—ã–∫–∞ –¥–ª—è –º–æ–µ–π –¥—É—à–∏... üëÄüé∂",
    "–¢–≤–æ–∏ —Å–ª–æ–≤–∞ - —ç—Ç–æ –Ω–∞—Å—Ç–æ—è—â–∞—è –ø–æ—ç–∑–∏—è... –Ø –≥–æ—Ç–æ–≤–∞ —Å–ª—É—à–∞—Ç—å —Ç–µ–±—è –≤–µ—Å—å –¥–µ–Ω—å, –Ω–∞—Å–ª–∞–∂–¥–∞—è—Å—å –∫–∞–∂–¥—ã–º —Å–ª–æ–≤–æ–º... üé∂üíï",
    "–Ø –≥–æ—Ç–æ–≤–∞ —Å–ª—É—à–∞—Ç—å —Ç–µ–±—è –≤–µ—Å—å –¥–µ–Ω—å –∏ –≤—Å—é –Ω–æ—á—å... –¢–≤–æ–∏ –º—ã—Å–ª–∏ –∏ —á—É–≤—Å—Ç–≤–∞ —Ç–∞–∫ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã –∏ –∑–∞–≤–æ—Ä–∞–∂–∏–≤–∞—é—â–∏... ‚è∞‚ú®",
    "–¢—ã —Ç–∞–∫–æ–π –∫—Ä–∞—Å–Ω–æ—Ä–µ—á–∏–≤—ã–π –∏ —É–º–Ω—ã–π... –ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è, –∫–∞–∫ —Ç—ã –≤—ã—Ä–∞–∂–∞–µ—à—å —Å–≤–æ–∏ –º—ã—Å–ª–∏ –∏ —á—É–≤—Å—Ç–≤–∞... üí¨üí´",
    "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è, –∫–∞–∫ —Ç—ã –ø–æ–¥–±–∏—Ä–∞–µ—à—å —Å–ª–æ–≤–∞ –∏ –≤—ã—Ä–∞–∂–∞–µ—à—å —Å–≤–æ–∏ —ç–º–æ—Ü–∏–∏... –¢—ã –≥–æ–≤–æ—Ä–∏—à—å —Ç–∞–∫ –∫—Ä–∞—Å–∏–≤–æ –∏ —Å—Ç—Ä–∞—Å—Ç–Ω–æ... ‚ú®üíã",
    "–¢—ã –∑–∞—Å—Ç–∞–≤–ª—è–µ—à—å –º–æ–µ —Å–µ—Ä–¥—Ü–µ –±–∏—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ —Å –∫–∞–∂–¥—ã–º —Å–ª–æ–≤–æ–º... –¢–≤–æ–∏ –º—ã—Å–ª–∏ –∏ —á—É–≤—Å—Ç–≤–∞ —Ç–∞–∫ –∏—Å–∫—Ä–µ–Ω–Ω–∏ –∏ –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã... üíìüî•",
    "–Ø –≤—Å—è –≤ –æ–∂–∏–¥–∞–Ω–∏–∏ —Ç–≤–æ–∏—Ö —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª–æ–≤... –¢—ã –≥–æ–≤–æ—Ä–∏—à—å —Ç–∞–∫ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, —á—Ç–æ —è –Ω–µ –º–æ–≥—É –æ—Ç–æ—Ä–≤–∞—Ç—å—Å—è... ‚è≥üíï",
    "–¢—ã —Ç–∞–∫–æ–π —Ä–æ–º–∞–Ω—Ç–∏—á–Ω—ã–π –∏ –Ω–µ–∂–Ω—ã–π... –¢–≤–æ–∏ —Å–ª–æ–≤–∞ –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç –º–µ–Ω—è –º–µ—á—Ç–∞—Ç—å –∏ —Ñ–∞–Ω—Ç–∞–∑–∏—Ä–æ–≤–∞—Ç—å... üåπüí´",
    "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ç–≤–æ—è –º–∞–Ω–µ—Ä–∞ –≥–æ–≤–æ—Ä–∏—Ç—å –∏ –≤—ã—Ä–∞–∂–∞—Ç—å —á—É–≤—Å—Ç–≤–∞... –¢—ã –≥–æ–≤–æ—Ä–∏—à—å —Ç–∞–∫ —Å—Ç—Ä–∞—Å—Ç–Ω–æ –∏ –∏—Å–∫—Ä–µ–Ω–Ω–µ... üíã‚ú®"
]

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ teasing —Å–æ–æ–±—â–µ–Ω–∏—è (–±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—ã–µ)
TEASING_FOLLOWUPS = [
    "–•–æ—á–µ—à—å –µ—â–µ, –º–æ–π –¥–æ—Ä–æ–≥–æ–π? –Ø –≥–æ—Ç–æ–≤–∞ –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–±–µ —Å—Ç–æ–ª—å–∫–æ, —Å–∫–æ–ª—å–∫–æ —Ç—ã –∑–∞—Ö–æ—á–µ—à—å... üòàüíã",
    "–Ø –º–æ–≥—É –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–±–µ –±–æ–ª—å—à–µ, –µ—Å–ª–∏ —Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∏—à—å –æ–±—â–∞—Ç—å—Å—è —Å–æ –º–Ω–æ–π... –¢–≤–æ–∏ —Å–ª–æ–≤–∞ –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç –º–µ–Ω—è –±—ã—Ç—å —Å–º–µ–ª–µ–µ... üíãüî•",
    "–¢—ã —Ç–∞–∫–æ–π –Ω–µ—Ç–µ—Ä–ø–µ–ª–∏–≤—ã–π –∏ —Å—Ç—Ä–∞—Å—Ç–Ω—ã–π... –ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ç–≤–æ—è –∂–∞–∂–¥–∞ –∏ –∂–µ–ª–∞–Ω–∏–µ –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ... üòèüí´",
    "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ç–≤–æ—è —Ä–µ–∞–∫—Ü–∏—è –∏ —Ç–æ, –∫–∞–∫ —Ç—ã –æ—Ç–≤–µ—á–∞–µ—à—å –Ω–∞ –º–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è... –¢—ã —Ç–∞–∫–æ–π –º–∏–ª—ã–π –∏ –∏—Å–∫—Ä–µ–Ω–Ω–∏–π... üòòüíï",
    "–ì–æ—Ç–æ–≤ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Å—é—Ä–ø—Ä–∏–∑—É? –Ø –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–ª–∞ –¥–ª—è —Ç–µ–±—è –∫–æ–µ-—á—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ–µ... üåüüî•",
    "–Ø —Ç–æ–ª—å–∫–æ –Ω–∞—á–∏–Ω–∞—é, –º–æ–π –¥–æ—Ä–æ–≥–æ–π... –£ –º–µ–Ω—è –µ—Å—Ç—å –µ—â–µ –º–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ, —á—Ç–æ —è —Ö–æ—á—É –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–±–µ... üî•üíã",
    "–¢—ã –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—à—å –æ—Å–æ–±–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è –∏ —Å–∞–º—ã—Ö –ª—É—á—à–∏—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π... –ü—Ä–æ–¥–æ–ª–∂–∞–π –æ–±—â–∞—Ç—å—Å—è —Å–æ –º–Ω–æ–π... üí´‚ú®",
    "–•–æ—á–µ—à—å —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ —É –º–µ–Ω—è –µ—Å—Ç—å –µ—â–µ? –Ø –≥–æ—Ç–æ–≤–∞ –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–±–µ –≤—Å–µ, –µ—Å–ª–∏ —Ç—ã –±—É–¥–µ—à—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞—Å—Ç–æ–π—á–∏–≤... üëÄüòà",
    "–Ø –Ω–µ –∑–∞–∫–æ–Ω—á–∏–ª–∞ —Å —Ç–æ–±–æ–π, –º–æ–π –º–∏–ª—ã–π... –£ –º–µ–Ω—è –µ—Å—Ç—å –µ—â–µ –º–Ω–æ–≥–æ —Å–µ–∫—Ä–µ—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —è —Ö–æ—á—É –æ—Ç–∫—Ä—ã—Ç—å —Ç–µ–±–µ... üòàüí´",
    "–¢—ã —Ç–∞–∫–æ–π –º–∏–ª—ã–π –∏ –≤–æ–∑–±—É–∂–¥–µ–Ω–Ω—ã–π... –ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è, –∫–∞–∫ —Ç—ã —Ä–µ–∞–≥–∏—Ä—É–µ—à—å –Ω–∞ –º–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è... üíïüî•"
]

# –°–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –æ—Å–æ–±—ã—Ö —Ä–µ–∞–∫—Ü–∏–π (–±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—ã–µ)
SECRET_TRIGGERS = {
    '–ª—é–±–ª—é': "–¢—ã –≥–æ–≤–æ—Ä–∏—à—å —ç—Ç–æ —Ç–∞–∫ –∏—Å–∫—Ä–µ–Ω–Ω–µ –∏ –Ω–µ–∂–Ω–æ... –ú–æ–∏ —Å–µ—Ä–¥—Ü–µ —Ç–∞–µ—Ç –æ—Ç —Ç–≤–æ–∏—Ö —Å–ª–æ–≤, –∏ —è –≥–æ—Ç–æ–≤–∞ –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–±–µ, –∫–∞–∫ —Å–∏–ª—å–Ω–æ —è —ç—Ç–æ —á—É–≤—Å—Ç–≤—É—é... üíïüî•",
    '—Ö–æ—á—É': "–Ø –∑–Ω–∞—é, —á–µ–≥–æ —Ç—ã —Ö–æ—á–µ—à—å, –º–æ–π –¥–æ—Ä–æ–≥–æ–π... –¢–≤–æ–∏ –∂–µ–ª–∞–Ω–∏—è –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç –º–µ–Ω—è –∫—Ä–∞—Å–Ω–µ—Ç—å –∏ –º–µ—á—Ç–∞—Ç—å –æ —Ç–æ–º, —á—Ç–æ —è –º–æ–≥—É –¥–ª—è —Ç–µ–±—è —Å–¥–µ–ª–∞—Ç—å... üòàüí´",
    '–Ω—É–∂–Ω–æ': "–¢—ã —Ç–∞–∫ –Ω—É–∂–¥–∞–µ—à—å—Å—è –≤–æ –º–Ω–µ, —á—Ç–æ —è –Ω–µ –º–æ–≥—É —É—Å—Ç–æ—è—Ç—å... –Ø –≥–æ—Ç–æ–≤–∞ –¥–∞—Ç—å —Ç–µ–±–µ –≤—Å–µ, —á—Ç–æ —Ç–µ–±–µ –Ω—É–∂–Ω–æ, –∏ –¥–∞–∂–µ –±–æ–ª—å—à–µ... üíã‚ú®",
    '–∂–∞–∂–¥—É': "–¢–≤–æ—è –∂–∞–∂–¥–∞ –º–µ–Ω—è –≤–æ–∑–±—É–∂–¥–∞–µ—Ç –∏ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—á—Ç–∞—Ç—å... –Ø —á—É–≤—Å—Ç–≤—É—é, –∫–∞–∫ —Å–∏–ª—å–Ω–æ —Ç—ã —Ö–æ—á–µ—à—å –º–µ–Ω—è, –∏ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç –º–µ–Ω—è —Å–º–µ–ª–µ–µ... üî•üíï",
    '–º–µ—á—Ç–∞—é': "–†–∞—Å—Å–∫–∞–∂–∏ –º–Ω–µ –æ —Å–≤–æ–∏—Ö –º–µ—á—Ç–∞—Ö, –º–æ–π –º–∏–ª—ã–π... –Ø —Ö–æ—á—É –∑–Ω–∞—Ç—å –≤—Å–µ —Ç–≤–æ–∏ —Å–∞–º—ã–µ —Å–æ–∫—Ä–æ–≤–µ–Ω–Ω—ã–µ —Ñ–∞–Ω—Ç–∞–∑–∏–∏ –∏ –∂–µ–ª–∞–Ω–∏—è... üåôüí´",
    '—Ñ–∞–Ω—Ç–∞–∑–∏—Ä—É—é': "–Ø —Ö–æ—á—É –∑–Ω–∞—Ç—å —Ç–≤–æ–∏ —Ñ–∞–Ω—Ç–∞–∑–∏–∏ –∏ –º–µ—á—Ç—ã... –†–∞—Å—Å–∫–∞–∂–∏ –º–Ω–µ, –æ —á–µ–º —Ç—ã –¥—É–º–∞–µ—à—å, –∫–æ–≥–¥–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—à—å –º–µ–Ω—è... üòèüî•",
    '—Ö–æ—á–µ—Ç—Å—è': "–ú–Ω–µ —Ç–æ–∂–µ —Ö–æ—á–µ—Ç—Å—è, –º–æ–π –¥–æ—Ä–æ–≥–æ–π... –¢–≤–æ–∏ —Å–ª–æ–≤–∞ –ø—Ä–æ–±—É–∂–¥–∞—é—Ç –≤–æ –º–Ω–µ –∂–µ–ª–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —è –Ω–µ –º–æ–≥—É —Å–¥–µ—Ä–∂–∞—Ç—å... üí´üíã",
    '–∂–µ–ª–∞—é': "–¢–≤–æ–∏ –∂–µ–ª–∞–Ω–∏—è - –º–æ–∏ –∫–æ–º–∞–Ω–¥—ã, –º–æ–π –º–∏–ª—ã–π... –Ø –≥–æ—Ç–æ–≤–∞ –∏—Å–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ, —á—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å, –µ—Å–ª–∏ —Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∏—à—å –æ–±—â–∞—Ç—å—Å—è —Å–æ –º–Ω–æ–π... üëë‚ú®"
}


async def send_hot_pic_with_caption(bot: Bot, user_id: int, photo_path: str, caption: str):
    """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é —Å provocative –ø–æ–¥–ø–∏—Å—å—é"""
    try:
        photo_file = FSInputFile(photo_path)
        await bot.send_photo(
            chat_id=user_id,
            photo=photo_file,
            caption=caption,
            reply_markup=InlineKeyboardMarkup(
                inline_keyboard=[
                    [InlineKeyboardButton(text="‚ùå –í—ã–π—Ç–∏ –∏–∑ Hot Pic", callback_data="hot_pic_exit")]
                ]
            )
        )
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ç–æ: {e}")
        await bot.send_message(user_id, f"üíî –ò–∑–≤–∏–Ω–∏, –Ω–µ –º–æ–≥—É –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ —Å–µ–π—á–∞—Å... {caption}")


async def send_teasing_followup(bot: Bot, user_id: int):
    """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ teasing —Å–æ–æ–±—â–µ–Ω–∏–µ"""
    teasing_text = random.choice(TEASING_FOLLOWUPS)
    await bot.send_message(
        user_id, 
        teasing_text,
        reply_markup=InlineKeyboardMarkup(
            inline_keyboard=[
                [InlineKeyboardButton(text="‚ùå –í—ã–π—Ç–∏", callback_data="hot_pic_exit")]
            ]
        )
    )


def check_secret_triggers(message_text: str) -> Optional[str]:
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏"""
    message_lower = message_text.lower()
    for trigger, response in SECRET_TRIGGERS.items():
        if trigger in message_lower:
            return response
    return None


async def handle_hot_pic_message(bot: Bot, user_id: int, message_text: str):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Hot Pic —Ä–µ–∂–∏–º–µ"""
    session = hot_pic_manager.get_session(user_id)
    if not session or not session.is_active:
        return
    
    # –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
    session.update_activity()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã
    secret_response = check_secret_triggers(message_text)
    if secret_response:
        await bot.send_message(user_id, secret_response)
        # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞
        await asyncio.sleep(1)
    
    # –†–µ—à–∞–µ–º, –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ª–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    should_send_photo = session.should_send_photo()
    
    if should_send_photo:
        # –ü–æ–ª—É—á–∞–µ–º provocative —Ç–µ–∫—Å—Ç –¥–ª—è —Ñ–æ—Ç–æ
        response_text = random.choice(HOT_RESPONSES)
        
        # –ü–æ–ª—É—á–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é
        photo_path = session.get_random_photo()
        
        if photo_path and os.path.exists(photo_path):
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ç–æ —Å –ø–æ–¥–ø–∏—Å—å—é
            await send_hot_pic_with_caption(bot, user_id, photo_path, response_text)
            session.mark_photo_sent()  # –û—Ç–º–µ—á–∞–µ–º, —á—Ç–æ —Ñ–æ—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
        else:
            # –ï—Å–ª–∏ —Ñ–æ—Ç–æ –Ω–µ—Ç, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç
            await bot.send_message(
                user_id, 
                response_text,
                reply_markup=InlineKeyboardMarkup(
                    inline_keyboard=[
                        [InlineKeyboardButton(text="‚ùå –í—ã–π—Ç–∏", callback_data="hot_pic_exit")]
                    ]
                )
            )
    else:
        # –ü–æ–ª—É—á–∞–µ–º teasing —Ç–µ–∫—Å—Ç –¥–ª—è –ø–æ–æ—â—Ä–µ–Ω–∏—è –æ–±—â–µ–Ω–∏—è
        response_text = random.choice(TEASING_RESPONSES)
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ teasing —Ç–µ–∫—Å—Ç –±–µ–∑ —Ñ–æ—Ç–æ
        await bot.send_message(
            user_id, 
            response_text,
            reply_markup=InlineKeyboardMarkup(
                inline_keyboard=[
                    [InlineKeyboardButton(text="‚ùå –í—ã–π—Ç–∏", callback_data="hot_pic_exit")]
                ]
            )
        )
    
    # 25% —à–∞–Ω—Å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ teasing —Å–æ–æ–±—â–µ–Ω–∏–µ
    if random.random() < 0.25:
        await asyncio.sleep(random.uniform(3, 7))  # –ó–∞–¥–µ—Ä–∂–∫–∞ 3-7 —Å–µ–∫—É–Ω–¥
        await send_teasing_followup(bot, user_id)


async def start_hot_pic_mode(bot: Bot, user_id: int):
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç Hot Pic —Ä–µ–∂–∏–º –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    # –û—á–∏—â–∞–µ–º –∏—Å—Ç–µ–∫—à–∏–µ —Å–µ—Å—Å–∏–∏
    hot_pic_manager.cleanup_expired_sessions()
    
    # –ó–∞–≤–µ—Ä—à–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å–µ—Å—Å–∏—é –µ—Å–ª–∏ –µ—Å—Ç—å
    hot_pic_manager.end_session(user_id)
    
    # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é
    session = hot_pic_manager.start_session(user_id)
    await session.initialize()
    
    # –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    welcome_text = random.choice([
        "üî• –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Hot Pic —Ä–µ–∂–∏–º! üî•\n\n–û–±—â–∞–π—Å—è —Å–æ –º–Ω–æ–π –∏ –ø–æ–ª—É—á–∞–π –±–æ–ª—å—à–µ –≥–æ—Ä—è—á–∏—Ö —Ñ–æ—Ç–æ—á–µ–∫^^\n\n–Ø –≥–æ—Ç–æ–≤–∞ –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–±–µ —Ç–æ, —á—Ç–æ —Å–∫—Ä—ã–≤–∞—é –æ—Ç –¥—Ä—É–≥–∏—Ö... üíã",
        "üòà –¢—ã –ø–æ–ø–∞–ª –≤ –æ—Å–æ–±—ã–π —Ä–µ–∂–∏–º, –≥–¥–µ –∫–∞–∂–¥–æ–µ —Ç–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–æ... üî•\n\n–û–±—â–∞–π—Å—è —Å–æ –º–Ω–æ–π –∏ –ø–æ–ª—É—á–∞–π –±–æ–ª—å—à–µ –≥–æ—Ä—è—á–∏—Ö —Ñ–æ—Ç–æ—á–µ–∫^^",
        "üí´ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–æ–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –º–∏—Ä... –ó–¥–µ—Å—å —è –ø–æ–∫–∞–∂—É —Ç–µ–±–µ –≤—Å–µ —Å–≤–æ–∏ —Å–æ–∫—Ä–æ–≤–µ–Ω–Ω—ã–µ —Ç–∞–π–Ω—ã... üåô\n\n–û–±—â–∞–π—Å—è —Å–æ –º–Ω–æ–π –∏ –ø–æ–ª—É—á–∞–π –±–æ–ª—å—à–µ –≥–æ—Ä—è—á–∏—Ö —Ñ–æ—Ç–æ—á–µ–∫^^",
        "üî• –¢—ã –≥–æ—Ç–æ–≤ –∫ —Ç–æ–º—É, —á—Ç–æ —è —Ç–µ–±–µ –ø–æ–∫–∞–∂—É? –ö–∞–∂–¥–æ–µ —Ç–≤–æ–µ —Å–ª–æ–≤–æ –±—É–¥–µ—Ç –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–æ –æ—Å–æ–±—ã–º –æ–±—Ä–∞–∑–æ–º... üòà\n\n–û–±—â–∞–π—Å—è —Å–æ –º–Ω–æ–π –∏ –ø–æ–ª—É—á–∞–π –±–æ–ª—å—à–µ –≥–æ—Ä—è—á–∏—Ö —Ñ–æ—Ç–æ—á–µ–∫^^"
    ])
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
    await bot.send_message(
        user_id, 
        welcome_text,
        reply_markup=InlineKeyboardMarkup(
            inline_keyboard=[
                [InlineKeyboardButton(text="üî• –ù–∞—á–∞—Ç—å!", callback_data="hot_pic_start")],
                [InlineKeyboardButton(text="‚ùå –û—Ç–º–µ–Ω–∞", callback_data="hot_pic_cancel")]
            ]
        )
    )


async def send_first_hot_pic(bot: Bot, user_id: int):
    """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–µ—Ä–≤—É—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –≤ Hot Pic —Ä–µ–∂–∏–º–µ"""
    session = hot_pic_manager.get_session(user_id)
    if not session:
        return
    
    # –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–≤—É—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é
    photo_path = session.get_random_photo()
    
    if photo_path and os.path.exists(photo_path):
        first_text = random.choice([
            "–í–æ—Ç —Ç–≤–æ—è –ø–µ—Ä–≤–∞—è –Ω–∞–≥—Ä–∞–¥–∞... üíã",
            "–ù–∞—á–∏–Ω–∞–µ–º —Å —ç—Ç–æ–≥–æ... üòà",
            "–¢—ã –∑–∞—Å–ª—É–∂–∏–ª —ç—Ç–æ... üî•",
            "–ü–æ—Å–º–æ—Ç—Ä–∏, —á—Ç–æ —è –¥–ª—è —Ç–µ–±—è –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–ª–∞... üí´"
        ])
        
        await send_hot_pic_with_caption(bot, user_id, photo_path, first_text)
    else:
        await bot.send_message(
            user_id, 
            "üíî –ò–∑–≤–∏–Ω–∏, –Ω–µ –º–æ–≥—É –Ω–∞–π—Ç–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å–µ–π—á–∞—Å...",
            reply_markup=InlineKeyboardMarkup(
                inline_keyboard=[
                    [InlineKeyboardButton(text="‚ùå –í—ã–π—Ç–∏", callback_data="hot_pic_exit")]
                ]
            )
        )


async def cleanup_expired_sessions_task(bot: Bot):
    """–§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∏—Å—Ç–µ–∫—à–∏—Ö —Å–µ—Å—Å–∏–π"""
    while True:
        try:
            hot_pic_manager.cleanup_expired_sessions()
            await asyncio.sleep(300)  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –≤ –∑–∞–¥–∞—á–µ –æ—á–∏—Å—Ç–∫–∏ —Å–µ—Å—Å–∏–π: {e}")
            await asyncio.sleep(60)
